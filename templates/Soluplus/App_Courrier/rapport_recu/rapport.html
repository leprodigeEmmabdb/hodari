{% extends 'Soluplus/MainApp/Utils/shared.html' %}

{% block page %}
  
<!--link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css" media="all"-->
<link href="https://cdn.datatables.net/buttons/1.6.1/css/buttons.dataTables.min.css" rel="stylesheet" type="text/css" media="all">

<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.print.min.js"></script>


<!-- Page-Title -->
<div class="row">
    <div class="col-sm-12">
        <h4 class="pull-left page-title">{{ title }}</h4>
        <ol class="breadcrumb pull-right">
            <li><a href="#">Accueil</a></li>
            <li class="active">Dashboard</li>
        </ol>
    </div>
</div>

<!-- Start Widget -->
<div class="row">
    <div class="col-md-3 col-sm-12">
        <div class="mini-stat clearfix bx-shadow">
            <span class="mini-stat-icon bg-info"><i class="ion-ios7-paperplane "></i></span>
            <div class="mini-stat-info text-right text-muted">
                <span class="">{{ total }}</span>
                
            </div>
            <div class="tiles-progress">
                <div class="m-t-20">
                    <h5 class="text-uppercase">Total des courriers</h5>
                    <div class="progress progress-sm m-0">
                        <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
                            <span class="sr-only">100% Complete</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-12">
        <div class="mini-stat clearfix bx-shadow">
            <span class="mini-stat-icon bg-danger"><i class="ion-ios7-paperplane "></i></span>
            <div class="mini-stat-info text-right text-muted">
                <span class="">{{ traites }}</span>
                
            </div>
            <div class="tiles-progress">
                <div class="m-t-20">
                    <h5 class="text-uppercase">Courriers traites</h5>
                    <div class="progress progress-sm m-0">
                        <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
                            <span class="sr-only">100% Complete</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-12">
        <div class="mini-stat clearfix bx-shadow">
            <span class="mini-stat-icon bg-purple"><i class="ion-ios7-cart"></i></span>
            <div class="mini-stat-info text-right text-muted">
                <span class="">{{ instance }}</span>
                
            </div>
            <div class="tiles-progress">
                <div class="m-t-20">
                    <h5 class="text-uppercase">Courriers en instance </h5>
                    <div class="progress progress-sm m-0">
                        <div class="progress-bar progress-bar-purple" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
                            <span class="sr-only">100% Complete</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 col-sm-12">
        <div class="mini-stat clearfix bx-shadow">
            <span class="mini-stat-icon bg-purple"><i class="ion-ios7-cart"></i></span>
            <div class="mini-stat-info text-right text-muted">
                <span class="">{{ retard }}</span>
                
            </div>
            <div class="tiles-progress">
                <div class="m-t-20">
                    <h5 class="text-uppercase">Courriers en retard </h5>
                    <div class="progress progress-sm m-0">
                        <div class="progress-bar progress-bar-purple" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
                            <span class="sr-only">100% Complete</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 


<br>  <br>

<div class="row">
    <div class="col-lg-12">
        <div class="portlet"><!-- /portlet heading -->
            <div class="portlet-heading">
                <h3 class="portlet-title text-dark text-uppercase">
                    Liste des courriers
                </h3>
                <div class="clearfix"></div>
            </div>
            
            <div class="row" style="padding: 10px;">
                
                <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="table-responsive">
                        <table id="datatable" class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Numero</th>
                                    <th>Date rec.</th>
                                    <th>Date Rép.</th>
                                    <th>Expéditeur</th>
                                    <th>Destinataires</th>
                                    <th>Objet</th>
                                    <th>Nature</th>
                                    <th>Etat</th>
                                </tr>
                            </thead>
                            
                            <tbody>

                                {% for item in model %}
                                    <tr>
                                        <td style="width: 10px;"></td>
                                        <td><a href="{% url 'app_courrier_details_arrivee' item.id%}">{{ item.numero }}</a></td>     
                                        <td>{{ item.date_reception | date:'d-m-Y'}}</td>
                                        <td>{{ item.date_reponse | date:'d-m-Y'}}</td>
                                        <td>{{ item.expediteur.nom }}</td>
                                        <td> 
                                            {% for itm in item.destinataires %}
                                                {{ itm.destinataire.nom_complet }} ,
                                            {% endfor %} 
                                        </td>
                                        <td>{{ item.objet }}</td>
                                        <td> {{item.nature.designation}} </td>
                                        <td>{{ item.etat }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div> <!-- /Portlet -->
    </div> <!-- end col -->
</div> <!-- End row -->


<script>
    $(document).ready(function() {
        $('#datatable').DataTable( {
            select: true,
            dom: 'Blfrtip',
            lengthMenu: [
                [10, 25, 50, -1],
                ['10', '25', '50', 'All']
            ],
        } );

        $('#datatable2').DataTable( {
            select: true,
            dom: 'Blfrtip',
            lengthMenu: [
                [10, 25, 50, -1],
                ['10', '25', '50', 'All']
            ],
        } );
    } );
</script>

<script type="text/javascript">
    $(document).ready(function () {
        var table = $('#datatable3').DataTable({
            select: true,
            dom: 'Blfrtip',
            lengthMenu: [
                [10, 25, 50, -1],
                ['10', '25', '50', 'All']
            ],
        });
        table.buttons().container()
            .appendTo('#datatable_wrapper .col-md-6:eq(0)');
    });
</script>

{% endblock %}